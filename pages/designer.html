<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Apply – Software Engineer | Oprah</title>
    <link href="../images/Oprah.png" rel="icon" />
    <link rel="stylesheet" href="../styles/jobcareer.css" />

     <!-- Include EmailJS Library -->
     <script type="text/javascript" src="https://cdn.emailjs.com/dist/email.min.js"></script>
     <script type="text/javascript">
       (function(){
         emailjs.init("OS_DgdTdYnwHf-c-4"); // Replace with your actual EmailJS Public Key
       })();
     </script>


    <!-- Font Awesome for icons if needed -->
    <link rel="stylesheet" href="../assets/fontawesome/CSS/all.css" />
  </head>
  <body>
     <!-- HEADER SECTION -->
   <header class="header">
    <div class="header-top container">
      <img class="logo" src="../images/Oprah.png" width="80" height="35" alt="Oprah Logo" />
      <nav class="nav">
        <a href="home.html">Home</a>
        <a href="about.html">About</a>
        <a href="blog.html">Blog</a>
        <a href="contact.html" class="contact">Contact Us</a>
      </nav>
    </div>
    <div class="hero container">
      <!-- Full-width hero with overlay --> 
      <div class="hero-overlay">
        <h1>UX/UI Designer</h1>
          <p>
            Create intuitive and engaging interfaces that transform healthcare experiences.
          </p>
      </div>
    </div>
  </header>


    <!-- APPLICATION FORM -->
    <main class="container">
      <section class="application-form-section">
        <h2>Apply Now</h2>
        <form id="apply-form" class="application-form" enctype="multipart/form-data">
          <div class="form-group">
            <label for="full-name">Full Name</label>
            <input type="text" id="full-name" name="fullname" placeholder="Your Full Name" required />
          </div>
          <div class="form-group">
            <label for="email">Email Address</label>
            <input type="email" id="email" name="email" placeholder="your@email.com" required />
          </div>
          <div class="form-group">
            <label for="phone">Phone Number</label>
            <input type="tel" id="phone" name="phone" placeholder="+1234567890" required />
          </div>
          <div class="form-group">
            <label for="cover-letter">Portfolio & Cover Letter</label>
            <textarea id="cover-letter" name="coverletter" rows="6" placeholder="Describe your experience and share links to your portfolio..." required></textarea>
          </div>
          <div class="form-group">
            <label for="resume">Resume</label>
            <input type="file" id="resume" name="resume" accept=".pdf,.doc,.docx" />
          </div>
          <button type="submit" class="btn-submit">Submit Application</button>
        </form>
      </section>
    </main>

     <!-- Loading Spinner -->
     <div id="spinner" class="spinner">
      <div></div>
    </div>

     <!-- Toast Notification -->
     <div id="toast" class="toast">Message sent successfully!</div>

     <!-- FOOTER SECTION -->
     <footer class="footer container">
      <div class="footer-logo">
        <img class="logo" id="logo1" src="../images/Oprah.png" width="80" height="35" alt="Oprah Logo" />
        <p class="footertxt">Understand, Track and Improve Your Health</p>
        <div class="download-links">
          <a href="#" class="store-link">
            <img src="../images/apple3.png" alt="App Store" />
            <span>Download on the App Store</span>
          </a>
          <a href="#" class="store-link">
            <img src="../images/playstore.png" width="49" height="49" alt="Google Play" />
            <span>Get it on Google Play</span>
          </a>
        </div>
      </div>
      <div class="footer-links">
        <div class="about-links">
          <h3>About Us</h3>
          <ul>
            <li><a href="#">Our Provider Digitalization Suite</a></li>
            <li><a href="#">Oprah Systems</a></li>
            <li><a href="#">Oprah Doc</a></li>
            <li><a href="#">Public Health &amp; Data Partnership</a></li>
            <li><a href="#">Data and Insights</a></li>
          </ul>
        </div>
        <div class="legal-links">
          <h3>Legal</h3>
          <ul>
            <li><a href="#">Terms of Use</a></li>
            <li><a href="#">Privacy Notice</a></li>
            <li><a href="#">Information Security</a></li>
            <li><a href="#">Oprah Service Levels</a></li>
            <li><a href="#">Cookie Notice</a></li>
            <li><a href="#">Consent for Children</a></li>
            <li><a href="#">Consent for Adult</a></li>
          </ul>
        </div>
        <div class="contact-info">
          <div class="location">
            <img src="../images/location.png" width="25" height="25" alt="Location Icon" />
            <p>Yaoundé, Cameroon</p>
          </div>
          <div class="phone">
            <img src="../images/phone.png" width="25" height="25" alt="Phone Icon" />
            <p>+237 679 724 561</p>
          </div>
          <div class="email">
            <img src="../images/mail.png" id="email" width="25" height="25" alt="Email Icon" />
            <p>oprahhealth@gmail.com</p>
          </div>
        </div>
      </div>
      <div class="footer-social">
        <a href="#"><img src="../images/instagram.png" width="25" height="25" alt="Instagram" /></a>
        <a href="#"><img src="../images/linkedin.png" width="25" height="25" alt="LinkedIn" /></a>
        <a href="#"><img src="../images/twitter.png" width="25" height="25" alt="Twitter" /></a>
        <a href="#"><img src="../images/youtube.png" width="25" height="25" alt="YouTube" /></a>
        <a href="#"><img src="../images/facebook.png" width="25" height="25" alt="Facebook" /></a>
      </div>
      <p class="copyright">&copy; 2025 Oprah. All Rights Reserved.</p>
    </footer>

    <!-- EmailJS Form Submission Script with Loading Spinner, Toast Notification, and Form Reset -->
    <script>
      document.getElementById('apply-form').addEventListener('submit', async function (e) {
        e.preventDefault();
    
        var spinner = document.getElementById('spinner');
        spinner.classList.add('show');
    
        const form = this;
        const fileInput = document.getElementById('resume');
        const file = fileInput.files[0];
    
        if (!file) {
          alert("Please upload a resume.");
          spinner.classList.remove('show');
          return;
        }
    
        // Read file as base64
        const reader = new FileReader();
        reader.onload = async function () {
          const base64 = reader.result.split(',')[1];
    
          // Upload to Google Drive via Apps Script
          const uploadResponse = await fetch('https://script.google.com/macros/s/AKfycbxF1I9AusJH88qNX5OSeGW5527GSd-j_ltRy_5Jb9QFURBqpnRHJJKLRlsqCsQulEU/exec', {
            method: 'POST',
            body: new URLSearchParams({
              file: base64,
              filename: file.name,
              mimeType: file.type
            }),
          });
    
          const fileUrl = await uploadResponse.text();
    
          if (fileUrl.startsWith("Error")) {
            alert("Upload failed: " + fileUrl);
            spinner.classList.remove('show');
            return;
          }
          console.log("Drive URL:", fileUrl);
    
          // Add hidden input for resume_link
          let hiddenInput = document.createElement("input");
          hiddenInput.type = "hidden";
          hiddenInput.name = "resume";
          hiddenInput.value = fileUrl;
          form.appendChild(hiddenInput);

          // after you've successfully appended your hidden resume_link input...
          fileInput.removeAttribute('name');   // <<-- this prevents the file from being included

    
          // Send form via EmailJS
          emailjs.sendForm("service_4mbywvc", "template_ayrjjp8", form)
            .then(function () {
              spinner.classList.remove('show');
              document.getElementById('toast').classList.add('show');
              form.reset();
              setTimeout(() => document.getElementById('toast').classList.remove('show'), 3000);
            }, function (error) {
              spinner.classList.remove('show');
              alert('Failed to send message.');
              console.error('EmailJS error:', error);
            });
        };
    
        reader.readAsDataURL(file);
      });
    </script>

  </body>
</html>
